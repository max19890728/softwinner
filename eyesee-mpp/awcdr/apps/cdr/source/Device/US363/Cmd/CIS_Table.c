/*******************************************************************************
 * Copyright (c), 2021, Ultracker Tech. All rights reserved.
 ******************************************************************************/

#include "Device/US363/Cmd/CIS_Table.h"

#include <stdio.h>
#include <stdlib.h>
#include <fcntl.h>
#include <malloc.h>
#include <pthread.h>
#include <sys/stat.h>
#include <sys/ioctl.h>

#include "common/app_log.h"
#include "Device/US363/Cmd/us360_define.h"
#include "Device/US363/Cmd/main_cmd.h"

#undef LOG_TAG
#define LOG_TAG "US363::CIS"

/*
 *	Full Scan
 *	VCYCLE:3575 HCYCLE:2016 (@MCLK)
 */
CIS_CMD_struct FS_TABLE[CIS_TAB_N] =
{
//	Chip_ID, Addr,	S_ID,	REV,	Data
      {0x81,	0x00,	0x00,	0x02},	/* 0 */
      {0x81,	0x05,	0xA2,	0x10},
//Wait >1ms
//PLSTMG register setting
      {0x81,	0x00,	0x00,	0x00},
//Wait >16ms
      {0x81,	0x00,	0x2C,	0x00},
      {0x81,	0x01,	0x0E,	0x11},
      {0x81,	0x03,	0x08,	0x13},
      {0x81,	0x03,	0x09,	0x10},
      {0x81,	0x03,	0x0A,	0x11},
      {0x81,	0x03,	0x20,	0x14},
      {0x81,	0x03,	0x21,	0x01},
      {0x81,	0x03,	0x22,	0x18},	/* 10 */
      {0x81,	0x03,	0x23,	0x00},
      {0x81,	0x03,	0x38,	0x00},
      {0x81,	0x03,	0x42,	0x06},
      {0x81,	0x03,	0x43,	0x00},
      {0x81,	0x03,	0x44,	0x13},
      {0x81,	0x03,	0x45,	0x01},
      {0x81,	0x03,	0x4A,	0x12},
      {0x81,	0x03,	0x4B,	0x01},
      {0x81,	0x03,	0x4C,	0x07},
      {0x81,	0x03,	0x4D,	0x00},	/* 20 */
      {0x81,	0x03,	0x52,	0x00},
      {0x81,	0x03,	0x53,	0x00},
      {0x81,	0x03,	0x54,	0x00},
      {0x81,	0x03,	0x59,	0x11},
      {0x81,	0x03,	0x5F,	0xFF},
      {0x81,	0x03,	0x60,	0x01},
      {0x81,	0x03,	0x61,	0x00},
      {0x81,	0x03,	0x62,	0x00},
      {0x81,	0x04,	0x06,	0x7E},
      {0x81,	0x04,	0x07,	0x00},	/* 30 */
      {0x81,	0x04,	0x8B,	0x01},
      {0x81,	0x05,	0x06,	0x1B},
      {0x81,	0x05,	0x07,	0x00},
      {0x81,	0x05,	0x0E,	0xB7},
      {0x81,	0x05,	0x0F,	0x00},
      {0x81,	0x05,	0x3E,	0x0C},
      {0x81,	0x05,	0x3F,	0x08},
      {0x81,	0x05,	0x40,	0x03},
      {0x81,	0x05,	0x42,	0x01},
      {0x81,	0x05,	0x5B,	0x00},	/* 40 */
      {0x81,	0x05,	0x78,	0xFF},
      {0x81,	0x05,	0x79,	0x01},
      {0x81,	0x05,	0x7A,	0x00},
      {0x81,	0x05,	0x7B,	0x00},
      {0x81,	0x05,	0x7D,	0x08},
//Mode.0 setting
      {0x81,	0x00,	0x02,	0x01},
      {0x81,	0x00,	0x01,	0x11},
                
      {0x81,	0x00,	0x03,	0x33},  //Mode0 setting
      {0x81,	0x00,	0x04,	0x00},
      {0x81,	0x00,	0x05,	0x03},	/* 50 */
      {0x81,	0x00,	0x06,	0x30},
      {0x81,	0x00,	0x07,	0x00},
      {0x81,	0x00,	0x08,	0x00},
//EP_Frame
      {0x81,	0x00,	0x0D,	0x00},	/* 54, Frame_L */
      {0x81,	0x00,	0x0E,	0x00},  /* 55, Frame_H */
      {0x81,	0x00,	0x1A,	0x00},	/* 56, vertical direction inversion readout */
      {0x81,	0x00,	0x6F,	0x00},
      {0x81,	0x00,	0x70,	0x00},
      {0x81,	0x00,	0x71,	0x00},
      {0x81,	0x00,	0x72,	0x00},	/* 60 */
      {0x81,	0x00,	0x7C,	0xF0},
      {0x81,	0x00,	0x7D,	0x03},
                
//EP_Integ      
      {0x81,	0x00,	0x0B,	0x00},	/* 63 */
      {0x81,	0x00,	0x0C,	0x07},
//AGain         
      {0x81,	0x00,	0x09,	0x00},
      {0x81,	0x00,	0x0A,	0x00},
//DGain         
      {0x81,	0x00,	0x11,	0x00},

      //{0x81,	0x00,	0x45,	0x01}
};

/*
 *	2x2 Bilinear
 *	VCYCLE:1820 HCYCLE:1320 (@MCLK)
 */
CIS_CMD_struct D2_TABLE[CIS_TAB_N] =  {
//	Chip_ID, Addr,	S_ID,	REV,	Data
      {0x81,	0x00,	0x00,	0x02},	/* 0 */
      {0x81,	0x05,	0xA2,	0x10},
//Wait >1ms
//PLSTMG register setting
      {0x81,	0x00,	0x00,	0x00},
//Wait >16ms
      {0x81,	0x00,	0x2C,	0x00},
      {0x81,	0x01,	0x0E,	0x11},
      {0x81,	0x03,	0x08,	0x13},
      {0x81,	0x03,	0x09,	0x10},
      {0x81,	0x03,	0x0A,	0x11},
      {0x81,	0x03,	0x20,	0x14},
      {0x81,	0x03,	0x21,	0x01},
      {0x81,	0x03,	0x22,	0x18},	/* 10 */
      {0x81,	0x03,	0x23,	0x00},
      {0x81,	0x03,	0x38,	0x00},
      {0x81,	0x03,	0x42,	0x06},
      {0x81,	0x03,	0x43,	0x00},
      {0x81,	0x03,	0x44,	0x13},
      {0x81,	0x03,	0x45,	0x01},
      {0x81,	0x03,	0x4A,	0x12},
      {0x81,	0x03,	0x4B,	0x01},
      {0x81,	0x03,	0x4C,	0x07},
      {0x81,	0x03,	0x4D,	0x00},	/* 20 */
      {0x81,	0x03,	0x52,	0x00},
      {0x81,	0x03,	0x53,	0x00},
      {0x81,	0x03,	0x54,	0x00},
      {0x81,	0x03,	0x59,	0x11},
      {0x81,	0x03,	0x5F,	0xFF},
      {0x81,	0x03,	0x60,	0x01},
      {0x81,	0x03,	0x61,	0x00},
      {0x81,	0x03,	0x62,	0x00},
      {0x81,	0x04,	0x06,	0x7E},
      {0x81,	0x04,	0x07,	0x00},	/* 30 */
      {0x81,	0x04,	0x8B,	0x01},
      {0x81,	0x05,	0x06,	0x1B},
      {0x81,	0x05,	0x07,	0x00},
      {0x81,	0x05,	0x0E,	0xB7},
      {0x81,	0x05,	0x0F,	0x00},
      {0x81,	0x05,	0x3E,	0x0C},
      {0x81,	0x05,	0x3F,	0x08},
      {0x81,	0x05,	0x40,	0x03},
      {0x81,	0x05,	0x42,	0x01},
      {0x81,	0x05,	0x5B,	0x00},	/* 40 */
      {0x81,	0x05,	0x78,	0xFF},
      {0x81,	0x05,	0x79,	0x01},
      {0x81,	0x05,	0x7A,	0x00},
      {0x81,	0x05,	0x7B,	0x00},
      {0x81,	0x05,	0x7D,	0x08},
//Mode.2A setting
      {0x81,	0x00,	0x02,	0x01},
      {0x81,	0x00,	0x01,	0x11},
                
      {0x81,	0x00,	0x03,	0x33},  //Mode2A setting
      {0x81,	0x00,	0x04,	0x10},
      {0x81,	0x00,	0x05,	0x11},	/* 50 */
      {0x81,	0x00,	0x06,	0x20},
      {0x81,	0x00,	0x07,	0x09},
      {0x81,	0x00,	0x08,	0x00},
//EP_Frame
      {0x81,	0x00,	0x0D,	0x00},	/* 54, Frame_L */
      {0x81,	0x00,	0x0E,	0x00},  /* 55, Frame_H */
      {0x81,	0x00,	0x1A,	0x00},	/* 56, vertical direction inversion readout */
      {0x81,	0x00,	0x6F,	0x00},
      {0x81,	0x00,	0x70,	0x00},
      {0x81,	0x00,	0x71,	0x00},
      {0x81,	0x00,	0x72,	0x00},	/* 60 */
      {0x81,	0x00,	0x7C,	0x94},
      {0x81,	0x00,	0x7D,	0x02},
                
//EP_Integ      
      {0x81,	0x00,	0x0B,	0x00},	/* 63 */
      {0x81,	0x00,	0x0C,	0x04},
//AGain         
      {0x81,	0x00,	0x09,	0x00},
      {0x81,	0x00,	0x0A,	0x00},
//DGain         
      {0x81,	0x00,	0x11,	0x00},
                
      //{0x81,	0x00,	0x45,	0x00}
};

/*
 *	3x3 Bilinear
 *	VCYCLE:1365 HCYCLE:880 (@MCLK)
 */
CIS_CMD_struct D3_TABLE[CIS_TAB_N] =  {
//	Chip_ID, Addr,	S_ID,	REV,	Data
      {0x81,	0x00,	0x00,	0x02},	/* 0 */
      {0x81,	0x05,	0xA2,	0x10},
//Wait >1ms
//PLSTMG register setting
      {0x81,	0x00,	0x00,	0x00},
//Wait >16ms
      {0x81,	0x00,	0x2C,	0x00},
      {0x81,	0x01,	0x0E,	0x11},
      {0x81,	0x03,	0x08,	0x13},
      {0x81,	0x03,	0x09,	0x10},
      {0x81,	0x03,	0x0A,	0x11},
      {0x81,	0x03,	0x20,	0x14},
      {0x81,	0x03,	0x21,	0x01},
      {0x81,	0x03,	0x22,	0x18},	/* 10 */
      {0x81,	0x03,	0x23,	0x00},
      {0x81,	0x03,	0x38,	0x00},
      {0x81,	0x03,	0x42,	0x06},
      {0x81,	0x03,	0x43,	0x00},
      {0x81,	0x03,	0x44,	0x13},
      {0x81,	0x03,	0x45,	0x01},
      {0x81,	0x03,	0x4A,	0x12},
      {0x81,	0x03,	0x4B,	0x01},
      {0x81,	0x03,	0x4C,	0x07},
      {0x81,	0x03,	0x4D,	0x00},	/* 20 */
      {0x81,	0x03,	0x52,	0x00},
      {0x81,	0x03,	0x53,	0x00},
      {0x81,	0x03,	0x54,	0x00},
      {0x81,	0x03,	0x59,	0x11},
      {0x81,	0x03,	0x5F,	0xFF},
      {0x81,	0x03,	0x60,	0x01},
      {0x81,	0x03,	0x61,	0x00},
      {0x81,	0x03,	0x62,	0x00},
      {0x81,	0x04,	0x06,	0x7E},
      {0x81,	0x04,	0x07,	0x00},	/* 30 */
      {0x81,	0x04,	0x8B,	0x01},
      {0x81,	0x05,	0x06,	0x1B},
      {0x81,	0x05,	0x07,	0x00},
      {0x81,	0x05,	0x0E,	0xB7},
      {0x81,	0x05,	0x0F,	0x00},
      {0x81,	0x05,	0x3E,	0x0C},
      {0x81,	0x05,	0x3F,	0x08},
      {0x81,	0x05,	0x40,	0x03},
      {0x81,	0x05,	0x42,	0x01},
      {0x81,	0x05,	0x5B,	0x00},	/* 40 */
      {0x81,	0x05,	0x78,	0xFF},
      {0x81,	0x05,	0x79,	0x01},
      {0x81,	0x05,	0x7A,	0x00},
      {0x81,	0x05,	0x7B,	0x00},
      {0x81,	0x05,	0x7D,	0x08},
//Mode.3 setting
      {0x81,	0x00,	0x02,	0x01},
      {0x81,	0x00,	0x01,	0x11},
                
      {0x81,	0x00,	0x03,	0x33},  //Mode3 setting
      {0x81,	0x00,	0x04,	0x14},
      {0x81,	0x00,	0x05,	0x19},	/* 50 */
      {0x81,	0x00,	0x06,	0x20},
      {0x81,	0x00,	0x07,	0x05},
      {0x81,	0x00,	0x08,	0x00},
//EP_Frame      
      {0x81,	0x00,	0x0D,	0x00},	/* 54, Frame_L */
      {0x81,	0x00,	0x0E,	0x00},  /* 55, Frame_H */
      {0x81,	0x00,	0x1A,	0x00},	/* 56, vertical direction inversion readout */
      {0x81,	0x00,	0x6F,	0x00},
      {0x81,	0x00,	0x70,	0x00},
      {0x81,	0x00,	0x71,	0x00},
      {0x81,	0x00,	0x72,	0x00},	/* 60 */
      {0x81,	0x00,	0x7C,	0xB8},
      {0x81,	0x00,	0x7D,	0x01},
                
//EP_Integ      
      {0x81,	0x00,	0x0B,	0x00},	/* 63 */
      {0x81,	0x00,	0x0C,	0x03},
//AGain         
      {0x81,	0x00,	0x09,	0x00},
      {0x81,	0x00,	0x0A,	0x00},
//DGain         
      {0x81,	0x00,	0x11,	0x00},
                
      //{0x81,	0x00,	0x45,	0x00}
};